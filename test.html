<!doctype html>
<html>
    <head>
        <title>Text Tree</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">		
        <link rel="stylesheet" href="test.css">

        <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
        <script src="http://code.jquery.com/jquery-latest.min.js"></script>
        <script type="text/javascript">
            function closeLayer(obj) {
                $(obj).parent().parent().hide();
            }

            $(function () {
                /* 클릭 클릭시 클릭을 클릭한 위치 근처에 레이어가 나타난다. */
                $('.popupWord').click(function (e) {
                    var sWidth = window.innerWidth;
                    var sHeight = window.innerHeight;

                    var oWidth = $('.popupLayer').width();
                    var oHeight = $('.popupLayer').height();

                    // 레이어가 나타날 위치를 셋팅한다.
                    var divLeft = e.clientX + 10;
                    var divTop = e.clientY + 10;

                    // 레이어가 화면 크기를 벗어나면 위치를 바꾸어 배치한다.
                    if (divLeft + oWidth > sWidth) divLeft -= oWidth;
                    if (divTop + oHeight > sHeight) divTop -= oHeight;

                    // 레이어 위치를 바꾸었더니 상단기준점(0,0) 밖으로 벗어난다면 상단기준점(0,0)에 배치하자.
                    if (divLeft < 0) divLeft = 0;
                    if (divTop < 0) divTop = 0;

                    var layer = document.getElementById("layer_" + e.target.getAttribute('name').replace(/[^0-9]/g, ''));
                    
                    layer.style.top = divTop+"px";
                    layer.style.left = divLeft+"px";
                    layer.style.display = "block";

                     /*
                    $('.popupLayer').css({
                        "top": divTop,
                        "left": divLeft,
                        "position": "absolute"
                    }).show(); */
                });

            });
        </script>
    </head>
<body>
    <div id="body">
        <div id="header">
            <h1>Text Tree (Test)</h1>
        </div>

        <div id="textblock">
            <h3>Test</h3>
            <p>
                <a class="popupWord" title="연관 단어 보기" name="word_1">테스트 단어</a>
            </p>
        </div>
        <div id="textblock">
            <h3>Test 2nd</h3>
            <p>
                <a class="popupWord" title="연관 단어 보기" name="word_2">또다른 단어</a>
            </p>
        </div>


        <div class="popupLayer" id="layer_1">
            <div>
                <span onclick="closeLayer(this)" style="cursor:pointer;font-size:1.5em" title="닫기">X</span>
            </div>
            테스트 단어와 연관된 단어가 나타난다.</br>
            1. <a class="popupWord" title="연관 단어 보기" name="word_2">또다른 단어</a></br>
            2. 아무튼 연관된 단어
        </div>

        <div class="popupLayer" id="layer_2">
            <div>
                <span onclick="closeLayer(this)" style="cursor:pointer;font-size:1.5em" title="닫기">X</span>
            </div>
            또다른 단어와 연관된 단어가 나타난다.</br>
            1. 이런 단어</br>
            2. 저런 단어</br>
            3. 그런 단어
        </div>

    </div>
</body>
</html>
